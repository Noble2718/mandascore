<html>
<!-- Full disclosure: JavaScript is not my forte and neither is CSS. -B -->
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta name="viewport" content="width=640, initial-scale=1">
<head>
    <title>Warframe Mandascore</title>
</head>
<!-- embedded favicon because why not -->
<link href="data:image/png;base64,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" rel="icon" type="image/png" />
<link rel="stylesheet" type="text/css" href="css/main.css"/>
<link rel="stylesheet" type="text/css" href="css/slider.css"/>
<body onload="initModel()" onkeydown="keyDown()" onresize="onresize()">
<script type="text/javascript" language="javascript" src="js/refs.js"></script>
<script type="text/javascript" language="javascript" src="js/util.js"></script>
<script type="text/javascript" language="javascript" src="js/undo.js"></script>
<script type="text/javascript" language="javascript" src="js/menus.js"></script>
<script type="text/javascript" language="javascript" src="js/song.js"></script>
<script type="text/javascript" language="javascript" src="js/lib/buffer-loader.js"></script>
<script type="text/javascript" language="javascript" src="js/audio.js"></script>
<script type="text/javascript" language="javascript" src="js/ui.js"></script>
<script type="text/javascript" language="javascript">


    //==============================================================
    // UI Builders
    //==============================================================

    function buildUI() {
        // the song UI goes inside the scoreArea div
        buildScore(document.getElementById("scoreArea"));
    }

    //==============================================================
    // Song Code updating
    //==============================================================

    // song code update state
    var songCodeUpdateDelay = 1000;
    var songCodeUpdateTimeout = null;
    var updatedSongCode = null;

    function updateSongCode() {
        // clear the old timeout if there is one
        if (songCodeUpdateTimeout) {
            clearTimeout(songCodeUpdateTimeout);
        }

        // set a timeout to update the code.  We don't want to do it with every single click.
        songCodeUpdateTimeout = setTimeout(() => { actuallyUpdateSongCode() }, songCodeUpdateDelay);
    }

    function actuallyUpdateSongCode() {
        // extract a song code from the UI
        updatedSongCode = getSongCode();
        // fill in the song code input box
        document.getElementById("songCode").value = updatedSongCode;
        // clear state
        songCodeUpdateTimeout = null;
    }

    function getSongCode() {
        return score.getSong();
    }

    function songCodeUpdated() {
        // pull the song code from the input box
        var input = document.getElementById("songCode");
        songCode = input.value.trim();
        // check if it's non-empty and changed
        if (songCode != null && songCode != "" && songCode != updatedSongCode) {
            // chrome is doing strange things with clicked buttons so just unfocus it
            input.blur();
            // load the song into the UI
            updateSong(songCode);
        }
    }

    function songCodeClicked() {
        // automatically select the whole song code if the input box is clicked
        var input = document.getElementById("songCode");
        input.select();
    }

    function setSongCode(songCode, disableUndo=false) {
        // set the song code explicitly, from the URL or the demo dropdown
        if (songCode !== null && songCode.length > 0) {
            // set the song code box
            var input = document.getElementById("songCode");
            input.value = updatedSongCode;
            // chrome is doing strange things with clicked buttons so just unfocus it
            input.blur();
            // load the song into the UI
            updateSong(songCode, disableUndo);
        }
    }

    function updateSong(songCode, disableUndo=false) {
        try {
            // load the song into the UI
            score.setSong(songCode, disableUndo);
            // success
            clearErrors();

        } catch (error) {
            // fail
            showErrors([error]);
            throw error;
        }
    }

    function demoSelected() {
        // pull the selected demo song code
        var input = document.getElementById("demoSelect");
        songCode = input.value.trim();
        if (songCode != null && songCode != "") {
            // update the UI
            setSongCode(songCode);
        }
    }

    //==============================================================
    // Model-View control
    //==============================================================

    var showHelpUrlString = "&h=yes";

    function initModel() {
        // javascript is working
        clearErrors();

        // set up the error listener
        window.onerror = windowOnError;
        // get the window size for menu placement
        onresize();

        // load the URL
        var url = window.location.href;

        // show the help section if the query prop is set
        if (getQueryParam(url, "h")) {
            about();
        }

        // init the UI
        buildUI();

        // load the model from the URL, if present
        reinitModel(url);
    }

    function reinitModel(url) {
        // on page load, see if there's a "song=..." query string
        var songCode = getQueryParam(url, "song", false);
        if (songCode) {
            // if there is, then initialize our song
            setSongCode(urlDecodeString(songCode, false), true);
        }

    }

    function copyModelUrl() {
        // build a model from the UI
        var songCode = getSongCode();

        var query = "?song=" + urlEncodeString(songCode, false)

        // build a full URL using the current URL
        var url = buildQueryUrl(query);

        // find the pop-up URL text field and set its contents
        var textField = document.getElementById("urlHolder");
        textField.value = url;
        // show the popup
        var popup = document.getElementById("popupBox");
        popup.classList.toggle("show");
        // focus and select the contents of the text field
        textField.focus();
        textField.select();
    }

    function hideUrlPopup() {
        // hide the popup when the text field loses focus
        var popup = document.getElementById("popupBox");
        popup.classList.toggle("show");
        // todo: the onBlur() event fails to get called sometimes in Chrome
    }

    function generatePng(button) {
        // chrome is doing strange things with clicked buttons so just unfocus it
        button.blur();
        // show the PNG menu and generate an image
        runPngMenu(button);
    }

    function about() {
        // chrome is weird with button focus now, make sure the about button is not in focus
        document.getElementById("about").blur();

        var container = document.getElementById("lotsOfWordsContainer")

        if (container.style.display === "none") {
            container.style.display = "block";

            // perform some history shenanigans to make sure that if you display Help, click a link, and then go back,
            // then Help is still displayed and you don't lose your place.
            var href = window.location.href;

            if (href.indexOf(showHelpUrlString) < 0) {
                if (href.indexOf("?") < 0) {
                    href += "?";
                }
                href += showHelpUrlString;
                history.replaceState( {} , document.title, href );
            }

        } else {
            container.style.display = "none";
            var href = window.location.href;
            var index = href.indexOf(showHelpUrlString)
            if (index >= 0) {
                href = href.substring(0, index) + href.substring(index + showHelpUrlString.length);
                history.replaceState( {} , document.title, href );
            }
        }
    }
</script>

<div class="titleBar">
    <div class="mainTitle">Mandachord Loop Editor</div>
</div>

<div id="errorBar">
    <div id="error">
        <div class="errorLine">Javascript not enabled.</div>
    </div>
</div>

<div class="songContainer">
    <div class="songDiv">
        <div class="util" id="demoSelectDiv">
            <div class="tooltip">
                <span class="label">Demo:</span>
                <select id="demoSelect" onchange="demoSelected(this);">
                    <option value="" selected></option>
                    <option value="[SONG-Adau Demo:AAAAAAAARAoAEQCAJEggCRAIAUSiABEAACDABAgpIQAKAECCkBAgoAAISYIAEgCARJQgASGIAEGAACFJAAgQQCIUEAiBBAEhYQAISAAoBEBKBBBChAoAhQCAKEogCJAIAYUSACEEgEhgQAoQgAI=:BardTennoPackA:BardTennoPackA:BardTennoPackA]">Adau</option>
                    <option value="[SONG-Alpha Demo:AAAAAAAAAIgACAgAAQmAAICABAiIAQAIAIIBgEBAgAABCAAICAAEEYACAIAEIQgBAAgIAQGAgICgAAIgABAKAAGhgAAAiAQCCAEGCACAAaEAAKAAACAAEIoABQGAABCUBAEIARQMAgIDgIBAwA==:BardCorpusPackA:BardCorpusPackA:BardCorpusPackA]">Alpha</option>
                    <option value="[SONG-Beta Demo:AAAAAAAAGAgAQQgABQEAABCABKAIATEIBBABABKQigAACABgiAAAAQAACIAEYAgBEQgEEAEAEYiCAAAIAGBIAAABAAAEgAQgCACQKAIQAQAQUIRAAAgAUQgAAAEAAhCgAIAKAIEIBBoBKBACQAw=:BardCorpusPackB:BardCorpusPackB:BardCorpusPackB]">Beta</option>
                    <option value="[SONG-Delta Demo:AAAAAAAAgCgAAAgAAAMBAQCgAAAgAQAIAAABAgAAoAAAIAAACgAAAwAAgKAAACAJAAoAASMACACggAAoAAAIAAgDAQAAoAAAIAEQCAAAAwBAAKAAACAABAoAAIMAAACgAAAoApACAECJAAQAoIA=:BardCorpusPackD:BardCorpusPackD:BardCorpusPackD]">Delta</option>
                    <option value="[SONG-Druk Demo:AAAAAAAAhCoQAAsIVCEAFhCoQQAhCUQqAAITAAUIgAGEKhAACwhUIQAWEKhCACkJRCoAAIcABEKAAaEoAABLQAADAAMEoAAAIgBISgAEAwACBKAAGKAAAEowAAOAAUigAgAhCAQqAAITAAUIgAE=:BardGrineerPackA:BardGrineerPackA:BardGrineerPackA]">Druk</option>
                    <option value="[SONG-Epsilon Demo:AAAAAAAAGAgEAAgwAAGAUGAAAAAoRAAIAEEBgCCAgABQCBAACKAAAYERQAAAACgQSAgAQAGIJACABKAICAAJQAABgJKAAAAALAgACABEAYBAgIAAwAggAAkAAAECBgCABAAIEFAIAEABEIQAgA==:BardCorpusPackE:BardCorpusPackE:BardCorpusPackE]">Epsilon</option>
                    <option value="[SONG-Gamma Demo:AAAAAAAAFCgACAAABQIwEBCgAAAQACAJAAQigAIAAAAgIAAQCAAKEuAQAIAEADAAIAEABAIAAgigABIoAAIAAAECEBAIoAQAFAEgCQAEAgACEKAAHAgAIAkABAaAAUCgAYAUAJAqAEUCAQSAgA==:BardCorpusPackC:BardCorpusPackC:BardCorpusPackC]">Gamma</option>
                    <option value="[SONG-Horos Demo:AAAAAAAAFCgAAAhAAEOAEgCAgQAgAEEIAAAjgIIBgAREKAAACEAAQ4ASAICBACAAQQgAAKOAhAGgBBEpAAAIAAATgBEAgCEAIQBASAAAE4ECEIAEESkAAAgAABOAEoCAIQAigEBMAAKTgQQQoA==:BardEDMPackA:BardEDMPackA:BardEDMPackA]">Horos</option>
                    <option value="[SONG-Plogg Demo:AAAAAAAAhCgAEAgAAIMAAhCgAEAgAQMKAAQLAAIAoABCKAAECgAAgwABCKAAECABAooAARMABQCgACCoAAQIAACDAACCoAAQIAECSgABCwAAgKAAQGAACAoAAIMAAQGgACAoAQIsAAITAAUIoA==:BardGrineerPackB:BardGrineerPackB:BardGrineerPackB]">Plogg</option>
                </select>
                <span class="tooltiptextbottom">Select an instrument set demo.</span>
            </div>
        </div>
        <div class="util" id="songCodeDiv">
            <div class="tooltip">
                <span class="label">Song Code:</span>
                <input id="songCode" class="songTitle" type="text" size="50" onchange="songCodeUpdated();" onclick="songCodeClicked()"/>
                <span class="tooltiptextbottom">Paste or copy the song code in here</span>
            </div>
        </div>
        <div class="util">
            <div class="popup">
                <input id="copyUrlButton" class="button urlButton popup" type="submit" value="Generate Link"
                       onClick="copyModelUrl()"/>
                <div class="popuptext" id="popupBox">
                    <input id="urlHolder" type="text" size="60" onblur="hideUrlPopup()"/>
                </div>
            </div>
        </div>
        <div class="util">
            <div class="tooltip">
                <input id="pngButton" class="button popup" type="submit" value="Generate PNG" onClick="generatePng(this)"/>
                <span class="tooltiptextbottom">Generate an image of the song</span>
            </div>
        </div>
    </div>
</div>


<div id="scoreArea">

</div>

<div class="titleBar">
    <div class="utilGroup">
        <div class="util">
            <span class="tooltip">
                <input id="about" class="button about" type="submit" value="Help" onClick="about()"/>
                <span class="tooltiptext">Click here for lots of words</span>
            </span>
        </div>
    </div>
    <div id="lotsOfWordsContainer" style="display: none;">
        <div class="lotsOfWords">
            <h1>What is this?</h1>
            <p>
                This is an app for viewing and editing Mandachord songs.
            </p>
            <p>
                The main motivation was to provide a way to be able to copy my songs into the game without having to
                pause a video.  But while I was at it I went ahead and made it a full blown editor.
            </p>
            <h2>Mandachord song codes?</h2>
            <p>
                There actually is a Mandachord song code format.  If you link a song in chat, and then look at your
                EE.log file after quitting Warframe, then you will see something like this:
            </p>
            <code>
                [SONG-Best Song Ever:AADDnwAAEggAAIggAEGBAJCAAABIAAAYAAgFwAECkCAgiAAAKEEACYAhAoAAAAgAAQgICCHAgQCQAEEIAABIQgAJgCEEgAAASAAIGAAABYAAIYAIIQgAAEgCBEGAABCAAAAIAAEIAAhBwgEAkA==:BardCorpusPackA:BardGrineerPackA:BardCorpusPackB]
            </code>
            <p>
                You used to be able to paste this back into the in-game chat window and get a song link back, but
                unfortunately that hasn't worked in a couple of years.  Still, it's as good a format as any, so that's
                what this editor is using.
            </p>
            <p>
                I have a program for extracting song codes from your EE.log file, if you're comfortable with
                running python: <a href="https://github.com/buff0000n/songparse">songparse</a>.
            </p>

            <h1>Table of Contents</h1>
            <ul id="TOC">
                <li><a href="#tocGettingStarted">Getting Started</a></li>
                <li><a href="#tocEditing">Basic Editing</a>
                    <ul>
                        <li><a href="#tocTitle">Title</a></li>
                        <li>
                            <a href="#tocInstruments">Instruments</a>
                            <ul>
                                <li><a href="#tocInstrumentSet">Instrument Set</a></li>
                                <li><a href="#tocVolume">Volume</a></li>
                                <li><a href="#tocIsolation">Isolation</a></li>
                            </ul>
                        </li>
                        <li><a href="#tocNotes">Notes</a></li>
                    </ul>
                </li>
                <li><a href="#tocAdvancedEditing">Advanced Editing</a>
                    <ul>
                        <li>
                            <a href="#tocClear">Clear</a>
                            <ul>
                                <li><a href="#tocClearMeasure">Clear Measure</a></li>
                                <li><a href="#tocClearSong">Clear Song</a></li>
                            </ul>
                        </li>
                        <li><a href="#tocCopy">Copy</a></li>
                        <li><a href="#tocPaste">Paste</a></li>
                    </ul>
                </li>
                <li><a href="#tocUndoRedo">Undo/Redo</a></li>
                <li><a href="#tocPlayback">Playback</a>
                    <ul>
                        <li><a href="#tocPlaySong">Play Song</a></li>
                        <li><a href="#tocPlayMeasure">Play Measure</a></li>
                    </ul>
                </li>
                <li><a href="#tocSaving">Saving</a>
                    <ul>
                        <li><a href="#tocSongCode">SongCode</a></li>
                        <li><a href="#tocShareURL">Share URL</a></li>
                        <li><a href="#tocExportToPng">Export to PNG</a></li>
                    </ul>
                </li>
                <li><a href="#tocToDo">To Do</a></li>
                <li><a href="#tocKnownIssues">Known Issues</a></li>
            </ul>

            <h1 id="tocGettingStarted">Getting Started</h1>
            <p>
                If you came here from a song link then it should already be displayed.
            </p>
            <p>
                If you have a song code then paste it in the <strong>Song Code</strong> text box and hit enter.
            </p>

            <h1 id="tocEditing">Basic Editing</h1>
            <p>
                If you're familiar with the in-game Mandachord editor then you already know how most of this works.
            </p>
            <h2 id="tocTitle">Title</h2>
            <p>
                Enter the title of the song here.  The in-game restrictions on Mandachord song titles are pretty
                severe, but the only thing being restricted here is a 25 character limit
            </p>
            <h2 id="tocInstruments">Instruments</h2>
            <p>
                You can adjust the settings here for each section individually: Percussion, Bass, and Melody.
            </p>
            <h3 id="tocInstrumentSet">Instrument Set</h3>
            <p>
               Use the dropdown to choose one of the nine instrument sets.
            </p>
            <h3 id="tocVolume">Volume</h3>
            <p>
                Use the slider to adjust the volume.  Full volume is all the way to thr right, zero volume is all the
                way to the left.
            </p>
            <h3 id="tocIsolation">Isolation</h3>
            <p>
                Use the checkboxes on the right to turn particular sections on and off.
            </p>
            <p>
                Note that the isolation settings are not part of the song code and don't get saved.
            </p>
            <h2 id="tocNotes">Notes</h2>
            <p>
                The rest of the screen is dedicated to the note grid.  This is laid out just like the Mandachord
                screen, except as a rectangle instead of a disc.
            <p>
                The top three rows are percussion, the next five are bass, and the bottom five are melody.  Time
                ordering goes from left to right.
            </p>
            <p>
                Click a location in the grid to turn a note on, or click a location with an existing note to turn that
                note off.  You can also click and drag across an area to create multiple notes next to each other.
            </p>
            <p>
                The score is broken out into four measures.  Each measure has a maximum number of notes that can be
                present in each section:
            </p>
            <ul>
                <li><strong>Percussion</strong>: 24 notes per measure</li>
                <li><strong>Bass</strong>: 16 notes per measure</li>
                <li><strong>Melody</strong>: 16 notes per measure</li>
            </ul>
            <p>
                <strong class="warn">Exceeding the note limit on a section of a measure will play a small warning sound.</strong>
            </p>
            <p>
                If your screen is wide enough then all four measures will be displayed in a single row.
                If your screen is not wide enough for that, then there will be two rows of two.
                If your screen is not wide enough for that the four measures will be arranged vertically.
            </p>
            <h1 id="tocAdvancedEditing">Advanced Editing</h1>
            <h2 id="tocClear">Clear</h2>
            <h3 id="tocClearMeasure">Clear Measure</h3>
            <p>
                Above each measure is a <strong>Clear</strong> button.  This can be used to clear part or all of the
                measure.  Clicking <strong>Clear</strong> will bring up a menu:
            </p>
            <ul>
                <li><strong>All</strong>: Use this to completely clear the measure</li>
                <li><strong>Percussion</strong>: Use this to clear just the Percussion section of the measure</li>
                <li><strong>Bass</strong>: Use this to clear just the Bass section of the measure</li>
                <li><strong>Melody</strong>: Use this to clear just the Melody section of the measure</li>
            </ul>
            <h3 id="tocClearSong">Clear Song</h3>
            <p>
                Above the <strong>Song Title</strong> bar is another <strong>Clear</strong> button.  This allows you to
                clear notes from all four measures.  It has the same options as the per-measure <strong>Clear</strong>
                button: <strong>All</strong>, <strong>Percussion</strong>, <strong>Bass</strong>, or
                <strong>Melody</strong>.
            </p>
            <h2 id="tocCopy">Copy</h2>
            <p>
                Above each measure is a <strong>Copy</strong> button.  This can be used to copy part or all of the
                measure, allowing it to be pasted to a different measure.  Clicking the <strong>Copy</strong> button
                will bring up the usual section options: <strong>All</strong>, <strong>Percussion</strong>,
                <strong>Bass</strong>, or <strong>Melody</strong>.
            </p>
            <p>
                Once a section is selected, it will be outlined in that measure.  If any changes are made to that
                section, or if the <strong>Copy</strong> button is clicked again, then the selection will be cleared.
            </p>
            <h2 id="tocPaste">Paste</h2>
            <p>
                Once a copy selection is made in one measure, the <strong>Paste</strong> buttons are enabled on the
                other three measures.  Clicking the <strong>Paste</strong> button will copy the selected section from
                the copied measure into that measure, overwriting any existing notes in that section.
            </p>
            <h1 id="tocUndoRedo">Undo/Redo</h1>
            <p>
                Undo and Redo is available using either the <strong>Undo</strong> and <strong>Redo</strong> buttons
                above the <strong>Song Title</strong> bar, or by using <strong>Ctrl-Z</strong> for undo and
                <strong>Ctrl-Shift-Z</strong> or <strong>Ctrl-Y</strong> for redo.
            </p>
            <p>
                All actions can be undone, including note changes, section setting changes, title changes, paste,
                clear, and loading a demo song.
            </p>
            <h1 id="tocPlayback">Playback</h1>
            <p>
                Use the <strong>Play buttons</strong> to start and stop playback on either all or part of the song.
                Playback will loop back to the beginning until stopped.
            </p>
            <p>
                Just like in game, the current playback location is marked with a vertical line, and individual notes
                will have a small visual bounce as they are played.
            </p>
            <p>
                Pressing <strong>Space</strong> during playback will pause at its current location.  Pressing
                <strong>Space</strong> again will resume playback where it left off.
            </p>
            <p>
                Pressing the same <strong>Play</strong> button while playing will stop playback and clear the current
                playback location.
            </p>
            <p>
                <strong class="warn">Note: The sounds themselves were recorded in-game.  I hope this is okay.</strong>
            </p>
            <h2 id="tocPlaySong">Play Song</h2>
            <p>
                Click the <strong>Play</strong> button above the <strong>Song Title</strong> bar to play the entire
                song.  Playback will go through all four measures before looping back to the beginning.
            </p>
            <h2 id="tocPlayMeasure">Play Measure</h2>
            <p>
                Click the <strong>Play</strong> button above a measure to play just that measure in a loop.
            </p>
            <p>
                Clicking the <strong>Play</strong> button above a different measure, or clicking the whole song
                <strong>Play</strong> button, will immediately stop the current playback and start a fresh playback
                on the clicked measure or song.
            </p>
            <h1 id="tocSaving">Saving</h1>
            <p>
                There are three ways to save your song for later: by code, by URL, or by generating and image.
            </p>
            <h2 id="tocSongCode">Song Code</h2>
            <p>
                To save your song by code, simply copy the code out of the <strong>Song Code</strong> bar at the top
                of the page.  This Song Code is automatically updated as changes are made to the song.
            </p>
            <p>
                To restore a song from a code, open this page again and paste the song code into the
                <strong>Song Code</strong> bar.
            </p>
            <p>
                <strong class="warn">Unfortunately, that's all you can currently do with a song code.</strong>  You used
                to be able to paste the song code into the in-game chat window and get a song link back, but that
                hasn't worked in years.
            </p>
            <h2 id="tocShareURL">Share URL</h2>
            <p>
                If you want a shareable URL that goes directly to your song, click the <strong>Generate Link</strong>
                button at the top of the page.  Copy this, and paste it into a browser to bring up this page
                auto-populated with your song.
            </p>
            <h2 id="tocExportToPng">Export to PNG</h2>
            <p>
                If you want an image, then click the <strong>Generate PNG</strong> button at the top of the page.
                This will bring up a link to download your song as a PNG, including section settings and all four
                measures.
            </p>
            <p>
                <strong>Note that you cannot re-import a PNG to edit it again.</strong>  You should also save your
                song as either a Song Code or URL so you can come back to it later.
            </p>

            <h1 id="tocToDo">To Do</h1>
            <ul>
                <li>
                   Maybe some icons instead of word buttons for play, stop, copy, paste, undo, redo.
                </li>
                <li>
                    Searchable database with my existing song library.  No idea how I'm going to do this.
                </li>
            </ul>


            <h1 id="tocKnownIssues">Known Issues</h1>
            <ul>
                <li>
                    There may be some delay when playing an instrument pack for the first time.  This is because of
                    the safeguards a lot of browsers have in place to prevent auto-play video and audio.  There isn't
                    much I can do about it.  You have to click something before it can even load the sounds.
                </li>
                <li>
                    The playback note animations sometimes cause Firefox to continually reload the note images
                    over and over again.
                </li>
                <li>
                    With Safari and possibly iOS, minimizing or otherwise hiding the window while it's playing will
                    stop the audio.  When you come back it takes a few tries playing and stopping before it fully
                    returns.  I'm not quite sure what's going on there yet.
                </li>
                <li>
                    I haven't fully figured out how the volume encoding works on the chat format, but I can
                    fake it enough to get reasonably close.
                </li>
            </ul>
        </div>
    </div>

    <div class="footerContainer">
        <div>
            <img src="https://i.imgur.com/b5pNXKU.png" srcset="https://i.imgur.com/z6U8Oxs.png 2x"/>
        </div>
        <div>
            Buff00n
        </div>
        <div>
            <a href="https://github.com/buff0000n/mandascore">Source</a>
            <a href="https://github.com/buff0000n/mandascore/issues/2 ">Feedback</a>
        </div>
        <div>
            v1.0.0: 2020-10-1
        </div>
        <div>
            <a href="https://warframe.com">Ninjas Jam Free</a>
        </div>
    </div>
</div>
</body>
</html>
